import{b as X,r as a,j as e,u as h,A as Y,T as Z,I as y,c as ee,d as x,B as c,M as te,e as M,L as oe,f as ne,g as se,h as re,H as ie,U as ae,P as ce,D as le,K as de,i as ue,k as xe,l as pe,m as he}from"./mui-F9xQZqB4.js";import{N as fe,u as me,a as O,O as N,G as je,L as ge,R as ye,b as d,c as be,r as g,H as we}from"./react-BDpBbo1c.js";import{a as k,A as B}from"./axios-Bkhu-6Ws.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();var H,I=X;H=I.createRoot,I.hydrateRoot;const Le={baseUrl:"",client:k.create()},U={authenticated:!1,baseUrl:"",jwtToken:null,logout:()=>Promise.resolve(),onLogin:()=>Promise.resolve(),user:null},F={setTitle:()=>{},title:""},G=a.createContext(U),Te=({baseUrl:t,children:n,onLogout:s,onRegisterUserAccount:r,onRequestSubscriberAccess:o,onSuccessfulLogin:i})=>{const[l,u]=a.useState(!1),[w,f]=a.useState(null),[L,m]=a.useState(null),T=async q=>{const D=new B;return D.set("token",q),k.post("/token",void 0,{baseURL:t,headers:D}).then(({data:j})=>{console.info(j);const{added:V,hasSubscriberRelationships:W,hasUserAccount:A,jwt:$,user:R}=j;f($),m(R);const J=R.subscriberRelationships.find(Q=>Q.status==="ACTIVE");if(A&&W&&J){u(!0),i();return}if(!A){r(V);return}o()}).catch(j=>{console.error(j)})},P=()=>(u(!1),f(null),m(null),s(),Promise.resolve());return e.jsx(G.Provider,{value:{authenticated:l,baseUrl:t,jwtToken:w,logout:P,onLogin:T,user:L},children:n})},b=()=>{try{return a.useContext(G)}catch(t){return console.warn(t),U}},z=({onLogoClicked:t,onLogoutClicked:n,onProfileClicked:s})=>{const{user:r}=b(),{palette:o,zIndex:i}=h(),[l,u]=a.useState(null),w=()=>{t==null||t()},f=()=>{n==null||n()},L=()=>{u(null)},m=P=>{u(P.currentTarget)},T=()=>{s==null||s()};return e.jsx(Y,{position:"fixed",sx:{zIndex:i.drawer+1},children:e.jsxs(Z,{disableGutters:!0,sx:{flexDirection:"row",justifyContent:r?"space-between":"center"},children:[e.jsxs(y,{"data-testid":"logo",disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,onClick:w,size:"large",sx:{color:o.common.white,gap:2},children:[e.jsx(ee,{sx:{color:o.common.white}}),e.jsx(x,{variant:"h5",children:"Promote4Me"})]}),r?e.jsxs(c,{children:[e.jsx(y,{"aria-controls":"headerbar-menu","aria-haspopup":"true","aria-label":"account of current user",color:"inherit",onClick:m,size:"large",children:e.jsx("img",{height:24,src:r.picture,style:{borderRadius:"40%",display:"inline-block",overflow:"hidden",verticalAlign:"middle"},width:24})}),e.jsxs(te,{anchorEl:l,anchorOrigin:{horizontal:"right",vertical:"top"},id:"headerbar-menu",keepMounted:!0,onClose:L,open:!!l,transformOrigin:{horizontal:"right",vertical:"top"},children:[e.jsx(M,{onClick:T,children:"Profile"}),e.jsx(M,{onClick:f,children:"Logout"})]})]}):e.jsx(e.Fragment,{})]})})},C=a.forwardRef(({href:t,...n},s)=>e.jsx(fe,{ref:s,to:t,...n})),v=({href:t,icon:n,iconOnly:s=!1,sx:r,text:o})=>e.jsxs(oe,{disableGutters:!0,LinkComponent:C,href:t,sx:{...r,justifyContent:"center",paddingRight:s?0:2},children:[e.jsx(ne,{sx:{justifyContent:"center"},children:n}),s?e.jsx(e.Fragment,{}):e.jsx(se,{primary:o})]}),Pe=({iconOnly:t=!1})=>e.jsx(c,{role:"presentation",children:e.jsxs(re,{className:"links-list",component:"nav",children:[e.jsx(v,{href:"/",icon:e.jsx(ie,{}),iconOnly:t,text:"Home"}),e.jsx(v,{href:"/photos/upload",icon:e.jsx(ae,{}),iconOnly:t,text:"Upload Photo"}),e.jsx(v,{href:"/photos",icon:e.jsx(ce,{}),iconOnly:t,text:"My Photos"})]})}),ve=()=>{const t=h(),[n,s]=a.useState(!0),r=()=>{s(!1)},o=()=>{s(!0)};return e.jsxs(le,{anchor:"left",className:"drawer-component",open:!0,PaperProps:{sx:{paddingTop:7,transitionDuration:300,transitionProperty:"width",transitionTimingFunction:"ease-in-out",width:n?t.spacing(22):t.spacing(5),[t.breakpoints.up("sm")]:{paddingTop:8}}},sx:{boxSizing:"border-box",flexShrink:0,whiteSpace:"nowrap",width:n?t.spacing(22):t.spacing(5),transitionDuration:300,transitionProperty:"width",transitionTimingFunction:"ease-in-out"},variant:"permanent",children:[e.jsx(Pe,{iconOnly:!n}),n?e.jsx(y,{"data-testid":"nav-collapse-btn",onClick:r,sx:{display:"flex",flexDirection:"row",justifyContent:"end"},children:e.jsx(de,{sx:{color:t.palette.common.white}})}):e.jsx(y,{"data-testid":"nav-expand-btn",onClick:o,children:e.jsx(ue,{sx:{color:t.palette.common.white}})})]})},Ce=()=>{const{authenticated:t,logout:n}=b(),s=me(),{breakpoints:r}=h(),o=()=>{s("/")},i=()=>{n().catch(u=>{console.error(u)})},l=()=>{s("/profile")};return t?e.jsxs(c,{sx:{display:"flex",flexGrow:1,flexDirection:"column"},children:[e.jsx(z,{onLogoClicked:o,onLogoutClicked:i,onProfileClicked:l}),e.jsxs(c,{sx:{display:"flex",flexGrow:1,flexDirection:"row",paddingTop:7,[r.up("sm")]:{paddingTop:8}},children:[e.jsx(ve,{}),e.jsx(N,{})]})]}):e.jsx(O,{to:"/login"})},ke=()=>{const{breakpoints:t}=h();return e.jsxs(c,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[e.jsx(z,{}),e.jsx(c,{sx:{display:"flex",flexGrow:1,flexDirection:"row",justifyContent:"center",paddingTop:7,[t.up("sm")]:{paddingTop:8}},children:e.jsx(N,{})})]})},K=a.createContext(F),De=({children:t,prefix:n,suffix:s})=>{const[r,o]=a.useState("");a.useEffect(()=>{window.document.title=r},[r]);const i=l=>{o((n??"").concat(l,s??""))};return e.jsx(K.Provider,{value:{setTitle:i,title:r},children:t})},p=()=>{try{return a.useContext(K)}catch(t){return console.warn(t),F}},Ae=()=>{const{setTitle:t}=p();return a.useEffect(()=>{t("Home")},[t]),e.jsx(c,{sx:{display:"flex",flexDirection:"column",padding:4},children:e.jsx(x,{children:"Home"})})},Re=()=>{const{authenticated:t,onLogin:n}=b(),{setTitle:s}=p();if(a.useEffect(()=>{s("Login")},[s]),t)return e.jsx(O,{to:"/"});const r=()=>{console.error("Login Failed")},o=i=>{if(!i.credential){console.warn("Missing JWT, cannot login");return}n(i.credential).then(()=>{}).catch(()=>{})};return e.jsx(c,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",padding:4},children:e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:4,justifyContent:"center",maxWidth:480},children:[e.jsx(x,{align:"center",variant:"h3",children:"Login"}),e.jsx(je,{onError:r,onSuccess:o})]})})},Me=()=>{const{palette:t}=h(),{setTitle:n}=p();return a.useEffect(()=>{n("Not Found")},[n]),e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(x,{children:"Not Found"}),e.jsx(xe,{component:ge,sx:{borderColor:t.primary.main,borderRadius:8,borderStyle:"solid",borderWidth:1,padding:2,textDecoration:"none"},to:"/",children:"Home"})]})},Ie=()=>{const{setTitle:t}=p();return a.useEffect(()=>{t("My Photos")},[t]),e.jsx(c,{sx:{display:"flex",flexDirection:"column",padding:4},children:e.jsx(x,{children:"My Photos"})})},Se=()=>{const{setTitle:t}=p();return a.useEffect(()=>{t("Photo Upload")},[t]),e.jsx(c,{sx:{display:"flex",flexDirection:"column",padding:4},children:e.jsx(x,{children:"Photo Upload"})})},Ee=()=>{const{setTitle:t}=p();return a.useEffect(()=>{t("Profile")},[t]),e.jsx(c,{sx:{display:"flex",flexDirection:"column",padding:4},children:e.jsx(x,{children:"Profile"})})},Oe=()=>e.jsxs(ye,{children:[e.jsxs(d,{element:e.jsx(Ce,{}),path:"/",children:[e.jsx(d,{element:e.jsx(Ae,{}),path:"/"}),e.jsx(d,{element:e.jsx(Se,{}),path:"photos/upload"}),e.jsx(d,{element:e.jsx(Ie,{}),path:"photos"}),e.jsx(d,{element:e.jsx(Ee,{}),path:"profile"})]}),e.jsxs(d,{element:e.jsx(ke,{}),path:"/",children:[e.jsx(d,{element:e.jsx(Re,{}),path:"login"}),e.jsx(d,{element:e.jsx(Me,{}),path:"*"})]})]}),Ne=a.createContext(Le),Be=({baseUrl:t,children:n})=>{const{jwtToken:s}=b(),r=a.useMemo(()=>{const o=new B({token:s});return k.create({baseURL:t,headers:o})},[t,s]);return e.jsx(Ne.Provider,{value:{baseUrl:t,client:r},children:n})},S="#080402",He="#fd7e23",Ue=pe({components:{MuiButtonBase:{defaultProps:{LinkComponent:C}},MuiInput:{defaultProps:{color:"primary"},styleOverrides:{input:{color:"#fff"}}},MuiLink:{defaultProps:{component:C}},MuiMenu:{styleOverrides:{paper:{backgroundColor:S}}},MuiPaper:{styleOverrides:{root:{backgroundColor:S,color:"rgb(188, 183, 174)"}}},MuiSvgIcon:{defaultProps:{color:"primary"}}},typography:{allVariants:{color:"#fff"}},palette:{primary:{main:He}}}),_="root",E=document.getElementById(_);if(E){const t="https://api.promote4.me/spa";H(E).render(e.jsx(a.StrictMode,{children:e.jsx(be,{clientId:"827056583868-lkgladofkkn2lf8n4afsipuno1k2bavj.apps.googleusercontent.com",children:e.jsx(Te,{baseUrl:t,onLogout:()=>{g("/login")},onRegisterUserAccount:r=>{g(`/register${r?"":"?hasVisited=true"}`)},onRequestSubscriberAccess:()=>{g("/request-subscriber-access")},onSuccessfulLogin:()=>{g("/")},children:e.jsx(Be,{baseUrl:t,children:e.jsx(we,{children:e.jsx(he,{theme:Ue,children:e.jsx(De,{suffix:" - P4Me Street",children:e.jsx(Oe,{})})})})})})})}))}else console.warn(`Could not find root HTML element w/ id = "${_}"`);
